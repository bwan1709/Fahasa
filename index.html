<!DOCTYPE html>
<html lang="en" ng-app="myApp">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ASM1</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
</head>

<body ng-controller="myCtrl">

    <div class="container-fluid p-0">
        <header>
            <div class="container-fluid p-0 m-0">
                <div class="container-fluid p-0 m-0">
                    <img src="img/banner.jpg" class="img-fluid w-100 banner" alt="">

                    <div class="container-fluid py-1 p-0">
                        <div class="navbars__PC">
                            <div class="row m-0">
                                <div class="col-md-3">
                                    <a href="#!"><img src="img/logo.webp" alt="Logo"
                                            style="max-width: 100%; height: auto;" /></a>
                                </div>
                                <div class="col-md-5 d-flex align-items-center">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Nhập tên sách muốn tìm"
                                            aria-label="Recipient's username" aria-describedby="button-addon2"
                                            ng-model="tukhoa" />
                                        <a href="#!TrangTimKiem">
                                            <button class="btn btn-outline-secondary btn-search" type="button"
                                                id="button-addon2">
                                                <i class="fa-solid fa-magnifying-glass"></i>
                                            </button>
                                        </a>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="col d-flex flex-row align-items-center">
                                        <div class="col-3 d-flex flex-column align-items-center justify-content-center">
                                            <i class="fa-solid fa-bell"></i>
                                            <span class="icon-text">Thông báo</span>
                                        </div>
                                        <div class="col-3 d-flex flex-column align-items-center justify-content-center">
                                            <a href="#!cart" class="text-dark" style="text-decoration: none; "><i
                                                    class="fa-solid fa-cart-shopping"></i>
                                            </a><span class="icon-text">Giỏ hàng</span>
                                        </div>
                                        <div
                                            class="col-3 d-flex flex-column align-items-center justify-content-center user">
                                            <a class="nav-link d-flex flex-column align-items-center"
                                                href="#!SignIn_SignUp" role="button" data-bs-toggle="dropdown"
                                                aria-expanded="false">
                                                <i class="fa-solid fa-user "></i>
                                                <span class="icon-text">Tài khoản</span>
                                            </a>
                                            <ul class="dropdown-menu p-0">
                                                <li><a class="dropdown-item" href="#!SignIn_SignUp">
                                                        <button type="button"
                                                            class="btn btn-signin btn-outline-danger w-100">Đăng
                                                            nhập</button>
                                                    </a></li>
                                                <li><a class="dropdown-item" href="#!SignIn_SignUp">
                                                        <button type="button"
                                                            class="btn btn-signup btn-outline-danger w-100">Đăng
                                                            ký</button>
                                                    </a></li>
                                                <li ng-show="hasUserData"><a class="dropdown-item" href="#!CRUD">
                                                        <button type="button"
                                                            class="btn btn-signup btn-outline-danger w-100">Sản
                                                            phẩm</button>
                                                    </a></li>
                                            </ul>
                                        </div>

                                        <div class="col-3 d-flex align-items-center justify-content-center">
                                            <div class="dropdown flag w-75">
                                                <button class="btn" type="button" data-bs-toggle="dropdown"
                                                    aria-expanded="false">
                                                    <a class="dropdown-item" href="#">
                                                        <img src="img/vi.webp" alt="English">
                                                    </a>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li>
                                                        <a class="dropdown-item w-75" href="#">
                                                            <img src="img/us.jpg" alt="English">
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="dropdown-item w-75" href="#">
                                                            <img src="img/vi.webp" alt="Tiếng Việt">
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="navbars__mobile py-3">
                            <div class="logo d-flex justify-content-center align-items-center mb-3">
                                <img src="img/logo.webp" alt="">
                            </div>
                            <div class="header-top-bars d-flex justify-content-center align-items-center">
                                <div class="input-group px-2">
                                    <button class="btn btn-outline-secondary btn-search" type="button"
                                        id="button-addon2">
                                        <i class="fa-solid fa-magnifying-glass"></i>
                                    </button>
                                    <input type="text" class="form-control" placeholder="Nhập tên sách muốn tìm"
                                        aria-label="Recipient's username" aria-describedby="button-addon2" />
                                </div>
                                <i class="fa-solid fa-cart-shopping"></i>
                                <i class="fa-solid fa-user"></i>
                            </div>
                        </div>
                    </div>
                </div>
        </header>




        <div ng-view></div>
        <footer>
            <div class="container py-3">
                <div class="row m-0">
                    <div class="col-sm-3">
                        <img src="img/logo.webp" alt="" class="mb-3" style="max-width: 100%;">
                        <p>Lầu 5, 387-389 Hai Bà Trưng Quận 3 TP HCMCông Ty Cổ Phần Phát Hành Sách TP HCM - FAHASA60 -
                            62 Lê Lợi, Quận 1, TP. HCM, Việt Nam.
                            <br>
                            Fahasa.com nhận đặt hàng trực tuyến và giao hàng tận nơi. KHÔNG hỗ trợ đặt mua và nhận hàng
                            trực tiếp tại văn phòng cũng như tất cả Hệ Thống Fahasa trên toàn quốc.
                            <br>
                        </p>
                        <img src="img/notificatied.png" class="mb-3" alt="" style="max-width: 40%;">
                        <br>
                        <div class="img-icon pb-0.25">
                            <img src="img/fb.png" alt="">
                            <img src="img/ins.png" alt="">
                            <img src="img/ytb.png" alt="">
                            <img src="img/t.png" alt="">
                            <img src="img/twt.png" alt="">
                            <img src="img/pint.png" alt="">
                        </div>
                        <br>
                        <img src="img/ggplay.png" alt="" style="max-width: 40%; margin-right: 20px;">
                        <img src="img/appstore.png" alt="" style="max-width: 40%;">
                    </div>



                    <div class="col-sm-3 d-flex">
                        <div class="col-1">
                            <div class="vertical-divider"></div>
                        </div>
                        <div class="col-11 ms-3 mt-3 mb-0">
                            <h3>DỊCH VỤ</h3>
                            <br>
                            <p class="mb-0">Điểu khoản sử dụng</p>
                            <br>
                            <p class="mb-0">Chính sách bảo vệ thông tin cá nhân</p>
                            <br>
                            <p class="mb-0">Chính sách bảo mật thanh toán</p>
                            <br>
                            <p class="mb-0">Giới thiệu Fahasa</p>
                            <br>
                            <p class="mb-0">Hệ thống trung tâm - Nhà sách</p>
                            <br>
                            <h3>LIÊN HỆ</h3>
                            <div>
                                <i class="fa-solid fa-location-dot">60-62 Lê Lợi, Q.1, TP. HCM</i>
                            </div>
                        </div>

                    </div>
                    <div class="col-sm-3">
                        <div class="ms-3 mt-3 mb-0">
                            <h3>HỖ TRỢ</h3>
                            <br>
                            <p class="mb-0">Chính sách đổi-trả-hoàn tiền</p>
                            <br>
                            <p class="mb-0">Chính sách bảo hành-bồi toàn</p>
                            <br>
                            <p class="mb-0">Chính sách vận chuyển</p>
                            <br>
                            <p class="mb-0">Chính sách khách sỉ</p>
                            <br>
                            <p class="mb-0">Phương thức thanh toán và xuất HĐ</p>
                            <br>

                            <br>
                            <i class="fa-solid fa-envelope">cskh@fahasa.com.vn</i>
                        </div>

                    </div>
                    <div class="col-sm-3">
                        <div class="ms-3 mt-3 mb-0">
                            <h3>TÀI KHOẢN CỦA TÔI</h3>
                            <br>
                            <p class="mb-0">Đăng nhập</p>
                            <br>
                            <p class="mb-0">Thay đổi địa chỉ khách hàng</p>
                            <br>
                            <p class="mb-0">Chi tiết tài khoản</p>
                            <br>
                            <p class="mb-0">Lịch sử mua hàng</p>
                            <br>
                            <p class="mb-0">Tạo mới tài khoản</p>
                            <br>
                            <br>
                            <i class="fa-solid fa-phone">1900636467</i>

                        </div>
                    </div>

                </div>

            </div>
        </footer>

    </div>


</body>
<script>
    var app = angular.module("myApp", ["ngRoute"]);
    app.config(function ($routeProvider) {
        $routeProvider
            .when("/", {
                templateUrl: "home.html",
                controller: 'homeController'
            })
            .when("/chitiet", {
                templateUrl: "chitiet.html",
                controller: 'chitietController'
            })
            .when("/TrangTimKiem", {
                templateUrl: "TrangTimKiem.html",
                controller: 'TrangTimKiemController'
            })
            .when("/SignIn_SignUp", {
                templateUrl: "SignIn_SignUp.html",
                controller: 'SignIn_SignUpController'
            })
            .when("/CRUD", {
                templateUrl: "CRUD.html",
                controller: 'CRUDController'
            })
            .when("/cart", {
                templateUrl: "cart.html",
                controller: 'cartController'
            });

    });
    app.controller("myCtrl", function ($scope, $http, $location, $rootScope) {
        $rootScope.hasUserData = true;
        $scope.Products = [];
        $scope.user = [];
        $scope.selectedProduct = null;
        $scope.cart = [];

        $scope.loadData = function () {
            $http.get("http://localhost:3000/Products")
                .then(res => {
                    $scope.Products = res.data
                    console.log($scope.Products)
                })
            $http.get("http://localhost:3000/users")
                .then(res => {
                    $scope.users = res.data
                })
        }
        $scope.loadData();
        var newSp = {
            id: $scope.Products.id,
            name: $scope.Products.name,
            tacgia: $scope.Products.tacgia,
            cost: $scope.Products.cost
        }
        $scope.addsp = function () {
            var newSp = {
                id: $scope.Products.id,
                name: $scope.Products.name,
                tacgia: $scope.Products.tacgia,
                cost: $scope.Products.cost
            };

            $http.post("http://localhost:3000/Products", newSp)
                .then(res => {
                    $scope.loadData();
                    $scope.Products.id = '';
                    $scope.Products.name = '';
                    $scope.Products.tacgia = '';
                    $scope.Products.cost = '';
                })
                .catch(error => {
                    console.error("Lỗi khi thêm sản phẩm:", error);
                });
        };


        $scope.deletesp = (id) => {
            $http.delete("http://localhost:3000/Products/" + id)
                .then(res => {
                    $scope.loadData();
                })
        }

        $scope.editsp = function (id) {
            $http.get("http://localhost:3000/Products/" + id)
                .then(res => {
                    $scope.editsp = res.data

                })
        }

        $scope.updatesp = function () {
            $http.put("http://localhost:3000/Products/" + $scope.editsp.id, $scope.editsp)
                .then(res => {
                    $scope.loadData()
                })
        }
        $scope.themvaogio = function (sp) {
            var index = $scope.cart.findIndex(p => p.id === sp.id);
            if (index >= 0) {
                $scope.cart[index].soluong++;
            } else {
                var spInCart = {
                    id: sp.id,
                    name: sp.name,
                    cost: sp.cost,
                    anh: sp.anh,
                    soluong: 1
                };
                $scope.cart.push(spInCart);
                // console.log($scope.cart);

            }
        };

        $scope.tongsoluong = function () {
            var tsl = 0;
            for (var i = 0; i < $scope.cart.length; i++) {
                tsl += $scope.cart[i].soluong;
            }
            return tsl;
        };

        $scope.tongtien = function () {
            var tt = 0;
            for (var i = 0; i < $scope.cart.length; i++) {
                tt += $scope.cart[i].soluong * $scope.cart[i].cost;
            }
            return tt;
        };

        $scope.xoa = function (index) {
            $scope.cart.splice(index, 1);
        };


        $scope.search = function (event) {
            $http.get("http://localhost:3000/Products")
                .then(res => {
                    $scope.Products = res.data.filter(Product >
                        Product.name.toLowerCase().includes($scope.txtSearch.toLowerCase())
                    )
                })
        }
        $scope.findProductById = function (productId) {
            for (var i = 0; i < $scope.Products.length; i++) {
                if ($scope.Products[i].id === productId) {
                    return $scope.Products[i];
                }
            }
            return null;
        };
        $scope.buyNow = function (productId) {
            var product = $scope.findProductById(productId);
            if (product) {
                $scope.selectedProduct = product;
            } else {
                console.log("Không tìm thấy sản phẩm có id: " + productId);
            }
        };
        // phân trang
        $scope.begin = 0;
        $scope.pageCount = Math.ceil($scope.Products.length / 4);
        $scope.loadData();
        $scope.first = function () {
            event.preventDefault();
            $scope.begin = 0;
        }
        $scope.prev = function () {
            event.preventDefault();
            if ($scope.begin > 0) {
                $scope.begin -= 4;
            }
        }
        $scope.next = function () {
            event.preventDefault();
            $scope.begin += 4;


        }
        $scope.last = function () {
            event.preventDefault();
            $scope.begin = ($scope.pageCount - 1) * 4;
        }
    });
    app.controller("cartController", function ($scope) {})
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/chitiet.js"></script>
<script src="js/home.js"></script>
<script src="js/timkiem.js"></script>
<script src="js/loginController.js"></script>
<script src="js/CRUD.js"></script>

</html>